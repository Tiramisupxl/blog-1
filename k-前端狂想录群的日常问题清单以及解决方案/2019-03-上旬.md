## 1号

### NO1

#### 问题描述
大佬们早，请教一个发布流程的问题，公司有多台服务器，怎么解决在发布那天总有用户在模版（html） 和静态资源发布的间隙访问页面导致资源不匹配的问题啊？

#### 问题解答
undefined 2019/03/01 上午9:28
nginx做健康检查

undefined 2019/03/01 上午9:29
不过你静态资源发布不上CDN吗？ 新的静态资源发布老的也会还在呀

レイン 2019/03/01 上午9:32
我们是覆盖式发布

レイン 2019/03/01 上午9:32
老得不会在

ChasLui 2019/03/01 上午9:33
蓝绿部署, 灰度发布

レイン 2019/03/01 上午9:33
都上cdn的

ChasLui 2019/03/01 上午9:34
好吧

undefined 2019/03/01 上午9:34
静态资源做下hash吧，覆盖式发布比较难避免

. 2019/03/01 上午9:34
他是发布间隙..

. 2019/03/01 上午9:34
说的是发布间隙

レイン 2019/03/01 上午9:35
就是因为灰度发布才会有这个问题啊，我5台服务器先发了A服务器用户从A访问我的页面，然后再加载页面中的静态资源的时候，我没有办法保证它还从A服务器访问啊，可能它就去B服务器取这个静态了，而此时B服务器还没发

レイン 2019/03/01 上午9:36
多台服务器的话，即是是非覆盖式发布好像也会有问题

陌上 2019/03/01 上午9:36
静态资源不覆盖，用版本号标示，不同版本的页面加载不同版本的静态资源，这样可以不

レイン 2019/03/01 上午9:36
除非只有一台超级服务器

断线人偶 2019/03/01 上午9:36
静态页面带hash，先部署静态资源，然后再部署动态请求的服务

断线人偶 2019/03/01 上午9:36
静态资源带上hash

レイン 2019/03/01 上午9:37
怎么可能html 带hash

レイン 2019/03/01 上午9:37
不会这么做的

undefined 2019/03/01 上午9:37
那就做健康检查呀，机器开始发布的时候，告诉nginx忽略这台机器，第一台机器好的时候，封闭其他服务器访问就可以了

☀💤喵喵 2019/03/01 上午9:37
这项目好大啊，还用几个服务器

☀💤喵喵 2019/03/01 上午9:37
[什么]

☀💤喵喵 2019/03/01 上午9:37
为啥要用那么多服务器呀

断线人偶 2019/03/01 上午9:37
html不带hash，我是说静态资源带hash

undefined 2019/03/01 上午9:38
为什么静态资源会和html在一台服务器上，cdn不是单独的服务器么。。

陌上 2019/03/01 上午9:38
这有什么为啥的，业务需求

断线人偶 2019/03/01 上午9:38
然后如果html是老的，无非是请求老的静态资源

レイン 2019/03/01 上午9:38
公司大啊，所以小公司不会存在这个问题[捂脸]

断线人偶 2019/03/01 上午9:38
然后新的html走新的静态资源

陌上 2019/03/01 上午9:38
所以你静态资源不要覆盖就行了

陌上 2019/03/01 上午9:38
就按照版本分开同时存在，定期清理老的

断线人偶 2019/03/01 上午9:38
我这边部署时，静态资源都是带hash的，不进行覆盖部署

ChasLui 2019/03/01 上午9:39
估计你们是静态资源都没带版本号也没带 hash 吧

ChasLui 2019/03/01 上午9:39
每次发布等于覆盖了

陌上 2019/03/01 上午9:39
你直接带hash不分版本，到后期东西越来越多维护起来都麻烦

レイン 2019/03/01 上午9:40
带了版本号的

陌上 2019/03/01 上午9:40
带了版本号还有什么问题

undefined 2019/03/01 上午9:40
。。他的意思应该是，请求从A服务器获取Html但是从B服务器获取静态资源了

レイン 2019/03/01 上午9:40
带了版本号跟非覆盖式发布是两回事

レイン 2019/03/01 上午9:40
带了版本号是覆盖式发布

レイン 2019/03/01 上午9:40
对

レイン 2019/03/01 上午9:40
undefined 懂我

断线人偶 2019/03/01 上午9:41
你说的版本号是指url的查询字符串中带了版本号吧……

undefined 2019/03/01 上午9:41
CDN应该是一个单独的集群

レイン 2019/03/01 上午9:41
是的

陌上 2019/03/01 上午9:41
你静态资源不是单独集群么

レイン 2019/03/01 上午9:41
vue发布的时候都是build后无差别的把构建后的包发布到各个节点

レイン 2019/03/01 上午9:42
模版和资源在一起的

レイン 2019/03/01 上午9:42
你们都是分开的？

undefined 2019/03/01 上午9:42
恩

断线人偶 2019/03/01 上午9:42
单独的

陌上 2019/03/01 上午9:42
单独做的啊，我们静态资源是放oss的

undefined 2019/03/01 上午9:42
静态资源单独上CDN

レイン 2019/03/01 上午9:42
你们cdn只放静态资源 不放html模版？

断线人偶 2019/03/01 上午9:42
静态资源单独上CDN+1

undefined 2019/03/01 上午9:43
html走vanish

レイン 2019/03/01 上午9:43
那你们模版单独放一个服务器还是多个

断线人偶 2019/03/01 上午9:43
多个

断线人偶 2019/03/01 上午9:43
但静态资源是带hash的，也就是说新老资源是同时存在的

レイン 2019/03/01 上午9:44
那就没差啊，还是会有问题

断线人偶 2019/03/01 上午9:44
如果请求到的是老的html，就走老的资源，请求到新的html就走新资源

断线人偶 2019/03/01 上午9:44
不会有问题

ChasLui 2019/03/01 上午9:44
不会有问题 访问老 html 加载老资源  访问新 html 加载新资源

陌上 2019/03/01 上午9:44
你进A服务器，新的html，访问的是CDN新的资源。有人进了B服务器，是老的html，访问CDN上老的资源

陌上 2019/03/01 上午9:45
还是有问题的问题出在哪

レイン 2019/03/01 上午9:45
所以你们是先发布静态 再发布模版对吧

ChasLui 2019/03/01 上午9:45
当然啊

レイン 2019/03/01 上午9:45
等等我缕缕

陌上 2019/03/01 上午9:45
静态资源肯定是先上传的

レイン 2019/03/01 上午9:45
有点乱

断线人偶 2019/03/01 上午9:46
肯定是先发布静态资源……不然就会出现请求404了

undefined 2019/03/01 上午9:46
一般的过程是先构建，再发布，构建把页面build了，静态资源上cdn，然后再一台一台机器发布html

. 2019/03/01 上午9:49
为什么不凌晨再release

呼吸 2019/03/01 上午9:49
紧急发布不能等

undefined 2019/03/01 上午9:49
一般不是非常大的改动，不需要凌晨release吧

呼吸 2019/03/01 上午9:49
[奸笑]

陌上 2019/03/01 上午9:50
选时间只是降低了问题带来的副作用但是并没有解决问题

レイン 2019/03/01 上午9:50
好像是没有问题了

レイン 2019/03/01 上午9:50
按照你们的套路来

陌上 2019/03/01 上午9:50
你这样就等于变成滚动式发布了

陌上 2019/03/01 上午9:50
肯定没问题啊

レイン 2019/03/01 上午9:50
都是凌晨发的。。。。

レイン 2019/03/01 上午9:50
凌晨三点

ChasLui 2019/03/01 上午9:51
凌晨发布不是解决问题的根本办法

レイン 2019/03/01 上午9:51
中午我得给我老大说一下，昨晚他把我搞蒙了

レイン 2019/03/01 上午9:51
关键还是要非覆盖式发布啊

undefined 2019/03/01 上午9:51
嗯啊

陌上 2019/03/01 上午9:51
覆盖式有问题的

陌上 2019/03/01 上午9:52
比如你上线发现了问题，也没有办法很快回滚，静态资源都覆盖了，还要重新把上版本代码重新打包发布

ChasLui 2019/03/01 上午9:52
而且也方便回滚,  要是万一出问题了, 把 html 还原就好了

レイン 2019/03/01 上午9:52
不，其实关键是要把html 和静态资源分开

レイン 2019/03/01 上午9:52
不能放一起上

レイン 2019/03/01 上午9:53
多谢 大佬们🙏



### NO2


#### 问题描述
请问vue-cli 3.0 怎么配置 配置 https://aaa.bbb.tech/index.html，   ，   build时改成  成  https://aaa.bbb.tech/staff/index.html 这种额 这种额
#### 问题解答
https://cli.vuejs.org/zh/config/#baseurl

去看看chain-webpak的api应该都有

### NO3

#### 问题描述
大佬们，有个换系统主题样式的需求，字体颜色可以解决，但是图标颜色有没有好的建议哈？

图标我现在是用的图片
#### 问题解答
Anx& 2019/03/01 上午11:11
svg 还是 font-icon

undefined 2019/03/01 上午11:12
原来是红色图标 要粉色就叠个CSS的白色透明遮罩上去，当然还是font-icon最好

简默丶Xs 2019/03/01 上午11:13
@undefined font-icon有文档吗，可以给我看看吗

L - 勋 2019/03/01 上午11:16
字体颜色是以什么方式换的，是更换样式文件吗？如果要换ui给的图片，直接改背景图路径不就行了

简默丶Xs 2019/03/01 上午11:16
不可能项目里放那么多不同颜色的图片1

简默丶Xs 2019/03/01 上午11:16
不现实啊

undefined 2019/03/01 上午11:16
iconfont.cn

undefined 2019/03/01 上午11:17
阿里的图标库，你可以参考下他的使用方式

undefined 2019/03/01 上午11:17
可以直接修改color来改变图标颜色的


### NO4

#### 问题描述
レイン 2019/03/02 14:27:04

你们公司的产品迭代没有做持续集成吗？发布的时候是怎么把build完后的包中的模版跟静态资源拆分开分别发的？
按你说的先发静态再发模版的方式，是本地拆好后发上去的吗？

#### 问题解答
陌上 2019/03/02 14:28:37

我们是把静态资源打包到static文件夹，然后把static上传到oss（阿里云的服务），其他的就传到对应服务器。

レイン 2019/03/02 14:31:05

那你们这两部操作是在哪里进行的，本地？我们这边是写的shell脚本在jenkins上做的构建打包，然后再打到服务器上的，这样就把构建完的产物整个都部署到服务器了没法拆分静态。

陌上 2019/03/02 14:31:32

打包机上运行的

レイン 2019/03/02 14:32:29

那你们也是用脚步做的拆分的工作？还是说你们的打包配置本来就没把模版和静态打到一起？

陌上 2019/03/02 14:33:19

打包配置就分开了，然后脚本负责对不同的文件做不同的上传。当然我觉得你打包完成以后用node去处理一下文件的目录结构也是可以的。

レイン 2019/03/02 14:34:57

打完再处理，感觉脚本会比较难写。

陌上 2019/03/02 14:40:48

还可以，毕竟你打包机肯定有node环境，用js写脚本就行了，在打包结束node运行一下。


### NO5

#### 问题描述
A? 

有人知道vue如何实现主动传值给父组件吗，就是只要子组件值变化了，就传给父组件

#### 问题解答
子组件触发父组件事件，把数据带过去


### NO6

#### 问题描述
A? 

微信一直没拿到openid，有大佬遇到过吗？

#### 问题解答
断线人偶

拿openid，除了文档上的调用顺序外，就是关于公众号后台相关的配置了，而且有安全域名的限制，然后微信公众号后台还有一些配置，主要是配置安全域名之类的。

A?

是不是走注册中心时，报错了

断线人偶

看一下后端的日志，另外，前端我记得微信js-sdk有一个debug的选项，可以看到具体是什么错

A?

微信菜单和后台是怎么交互的

断线人偶

微信的菜单只是配置一些安全调用域名以及ip白名单之类的，然后需要获取openid时，前端页面发ajax请求到后台，后台按微信文档的要求拼接好请求串后加给前端，前端直接访问，此时微信中的H5页面就会弹窗让用户授权，用户授权之后会将授权码返回给你之前拼接的回调地址拿，然后授权码，再拼接请求用户信息的url，请求正常返回就可以拿到用户的信息了……


### NO7

#### 问题描述
A?

JS 如何定义一个数组啊？

#### 问题解答
姬如雪

var a = new Array();
var a = ["first", "second", "third"];

A？

能直接a=b，把b数组赋值给a吗？

姬如雪

js里的数组就是指针，你这样是让a和b指向同一块内存

### NO8

A？
```
function fun (n, o) {
  console.log(o);
  return {
    fun: function (m) {
      return fun(m, n);
    }
  }
}

var c = fun(0).fun(1);
c.fun(2);
c.fun(3);

我有问题请教，var c = fun(0).fun(1); 这里怎么调用的？
```

#### 问题解答
白熊

fun(0)，第二个参没传，打印ubdefined,返回一个对象，有一个fun属性，然后点fun(1)就是调用这个fun属性，此时m是1，n是上次传的0，就是fun(1,0)，又返回一个对象(最后赋值给c)，有一个fun属性，之后的调用c.fun(x)，不管传什么，打印的都是最近一次调用fun函数时传进来的第一个参数，就是打印1

### NO9

#### 问题描述
问个api， 我记得有一个api, 给出一个数字100，就能返回一个数组[0,1,2,3,.......99,100]

#### 问题解答
ChasLui

Array.from({length:100}, (v,k) => k)

### NO10

#### 问题描述
有没有写过Node.js的C++ Addons的大佬，macOS debug环境是用lldb还是cppvsbdg啊

#### 问题解答
吃圡死月不會碼代碼

lldb 启动 node

### NO11

#### 问题描述
宁柏龙

大家是怎么避免 图片加载引起的回流的？

#### 问题解答
undefined

提前占位，如果知道图片比例的话

宁柏龙

?怎么个张占法？抱一个宽度固定的盒子吗？

. 

图片路径后面带尺寸参数

undefined

padding-bottom占位

宁柏龙

@.这个不是很灵活吧？

.

看应用场景。绝对灵活性能没有那么好吧

宁柏龙

我在css里写了宽高，然后把netwrok模拟成3g，肉眼可以看到 图片先加载 再改变布局...

王思远

防止重排不管什么方式都需要知道图片的信息吧，不论是尺寸还是具体的宽高，否则一定会重排的吧？


### NO12

#### 问题描述

路飞提问

第一个问题：目前前端，存不存在一套完美的自适应方案，比如H5自适应这块。比如后面要来的方屏(华为)

第二个问题：在缓存上，全栈级别的缓存是如何做的，前端缓存的难点在哪，有没有bp。

第三个问题：能不能以一种通俗的角度去理解构造函数和对象互为实例这个结论。

第四个问题：如何用派生类型去分析对象之间存在的原型关系。

欢迎讨论，发表看法。


### NO13

#### 问题描述
龙骑士-尹志平

问一下大家，你们公司中，后台管理系统的权限是怎么实现的？完全有后台来控制还是前端来实现？

#### 问题解答
雪鹰

我们的是后端控制的，有模块权限的

ISXMG

都要实现，前端根据权限数据动态注册菜单和路由，后端拦截控制api访问

我要割麦子

@龙骑士-尹志平 你可以了解下rbac和auth，两种权限管理系统的设计与实现

龙骑士-尹志平

我公司的后台管理系统是后台返给前端，前端取到对应的字段来判断显示与否

我要割麦子

这个都是在后端处理吧，前端没有数据源怎么知道显示？

ChasLui

@龙骑士-尹志平 可以参考下这篇文章 https://juejin.im/post/5c30c666518825261c1b7191

我要割麦子

这个是用rbac实现的


### NO14

#### 问题描述
.

有没有什么什么工具函数能比较两个对象并且返回差异的那部分？

#### 问题解答
QUJU

http://ramda.cn/docs/#symmetricDifference @.，这个是比较数组的，我之前用过，对象的应该也好实现

.
我找到了这个，https://www.npmjs.com/package/diff

A

Lodash

.
我找了lodash没看到，数组就有，在写mongodb的增量更新

路飞

比较对象的，返回差异的。是浅比较还是深比较，可以尝试在一些源码库里搜一下对应的关键词，可以搜一下 value-equal.js，改一改就好了

value-equal.js
```
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

function valueEqual(a, b) {
  if (a === b) return true;
  if (a == null || b == null) return false;
  if (Array.isArray(a)) {
    return Array.isArray(b) && a.length === b.length && a.every(function (item, index) {
      return valueEqual(item, b[index]);
    });
  }
  var aType = typeof a === 'undefined' ? 'undefined' : _typeof(a);
  var bType = typeof b === 'undefined' ? 'undefined' : _typeof(b);
  if (aType !== bType) return false;
  if (aType === 'object') {
    var aValue = a.valueOf();
    var bValue = b.valueOf();
    if (aValue !== a || bValue !== b) return valueEqual(aValue, bValue);
    var aKeys = Object.keys(a);
    var bKeys = Object.keys(b);
    if (aKeys.length !== bKeys.length) return false;
    return aKeys.every(function (key) {
      return valueEqual(a[key], b[key]);
    });
  }
  return false;
}
export default valueEqual;
```

### NO15

#### 问题描述
Ng Ui-hua

现在要让我加个请求错误跳转错误页，求支招，error的回调要写哪里呀

#### 问题解答
路飞

@Ng Ui-hua 你或许可以对post动手，通过一层代理完成ajax。当然如果这种形式很确定，是不是可以写一个babel插件来转换一下。胡诌完毕。

Ng Ui-hua

写一层代理还是要对写在各个文件的post进行手动改动？写babel插件这么高端的工作我是做不来😂

路飞

@Ng Ui-hua babel插件不高端，你可以去看看开源的插件怎么玩的。照猫画虎可以的。当然还得考虑现实情况，看你心情吧。ctrl c ctrl v快乐了也可以


### NO16

#### 问题描述
路飞

突然想到一个问题，前端跨域，各种什么顶级域名不同不行，子域名不同不行。ip不同不行。那浏览器底层是通过一种方式进行判断的呢。字符串比较？正则？总不能死记硬背各种规则api

#### 问题解答
炫

这个不是在浏览器判定的吧，好像在服务端吧？

波比小金刚

@炫 跨域是浏览器拦截的

炫

在浏览器的请求中，跨域是不是只在ajax这种异步请求中出现？

.

@炫 还有iframe，浏览器的同源策略了解一下

炫

正在看这方面内容
前文提到的由 XMLHttpRequest 或 Fetch 发起的跨域 HTTP 请求。
Web 字体 (CSS 中通过 @font-face 使用跨域字体资源), 因此，网站就可以发布 TrueType 字体资源，并只允许已授权网站进行跨站调用。
WebGL 贴图
使用 drawImage 将 Images/video 画面绘制到 canvas
样式表（使用 CSSOM）


### NO17

#### 问题描述
レイン

大佬们，我们为啥引得是这个版本啊

#### 问题解答
.

@レイン 因为webpack是基于node的模块打包工具，所以用common的比用esm的直接

レイン

嗯嗯 那我们为啥不用vue.runtime.common.js ？？？，不是说好了，我build的时候会自动把模版编译好的吗？为啥还要用完整版的构建，有这么多版本

.

因为你开发过程中他需要编译模板吧。最终打包进bundle里的应该只有runtime部分

レイン
开发过程中的编译是vue-loader做的还是vue做的？没看见哪里说最终打包进去的只有runtime啊

Ng Ui-hua

vue loader我记得是识别.vue文件

.

@レイン 会split，splitChunks，只打包进被用到的代码，如果生产环境只需要runtime部分的话，就只打包这一部分


### NO18

#### 问题描述
狼

大佬们，升级node的时候，报Error: invalid version 11.10.1，有什么办法处理吗

#### 问题解答
我的小羊在睡觉

把电脑中的所有东西删干净，就是node的包

undefined

你是怎么安装的node?

狼

直接用命令升级，安装了一个n命令，然后n stable，@我的小羊在睡觉 要手动清除吗

我的小羊在睡觉

嗯，手动

狼

搞好了，谢谢


### NO19

#### 问题描述
太阳当空照

let a = [{id:1},{id:2}] 有没有很简单操作 可以从a得到 b=[1,2]

#### 问题解答
.
a.map(item => item.id)


### NO20

#### 问题描述
追梦人

websocket连接被拒绝是什么原因？有人遇到过没

#### 问题解答
我要割麦子

端口号开了吗？

追梦人

我写端口号了

我要割麦子

服务端的端口号呢？

追梦人

也写了

我要割麦子

你得看下服务端的这个端口号是空闲的吗，不是写不写的问题啊，是被占用的问题，你写的这个端口号可能在干别的事情

追梦人

昨天刚学的，不太理解，怎么看端口号又没又被占用

### NO21

#### 问题描述
追梦人

有人知道js怎么解析二进制不？


#### 问题解答
林键燃

明白。二进制文件的处理

追梦人

怎么运用到js中，我看了也能理解

林键燃

我做过一个应用场景是读取图片，然后上传给服务器，你需要一个具体的应用场景，比如移动端读取用户相册图片，压缩，上传

追梦人

那数据不是从后端读取过来的吗

林键燃

手机里的图片，是客户端，上传后，通过对应的 URI 就是访问到该图片。当然这张图片是被图片服务器正确处理的，使用 JS 的 FileReader 可以读取二进制大文件，然后就可以上传给服务器了
