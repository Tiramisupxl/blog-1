## 1号

### NO1

#### 问题描述
大佬们早，请教一个发布流程的问题，公司有多台服务器，怎么解决在发布那天总有用户在模版（html） 和静态资源发布的间隙访问页面导致资源不匹配的问题啊？

#### 问题解答
undefined 2019/03/01 上午9:28
nginx做健康检查

undefined 2019/03/01 上午9:29
不过你静态资源发布不上CDN吗？ 新的静态资源发布老的也会还在呀

レイン 2019/03/01 上午9:32
我们是覆盖式发布

レイン 2019/03/01 上午9:32
老得不会在

ChasLui 2019/03/01 上午9:33
蓝绿部署, 灰度发布

レイン 2019/03/01 上午9:33
都上cdn的

ChasLui 2019/03/01 上午9:34
好吧

undefined 2019/03/01 上午9:34
静态资源做下hash吧，覆盖式发布比较难避免

. 2019/03/01 上午9:34
他是发布间隙..

. 2019/03/01 上午9:34
说的是发布间隙

レイン 2019/03/01 上午9:35
就是因为灰度发布才会有这个问题啊，我5台服务器先发了A服务器用户从A访问我的页面，然后再加载页面中的静态资源的时候，我没有办法保证它还从A服务器访问啊，可能它就去B服务器取这个静态了，而此时B服务器还没发

レイン 2019/03/01 上午9:36
多台服务器的话，即是是非覆盖式发布好像也会有问题

陌上 2019/03/01 上午9:36
静态资源不覆盖，用版本号标示，不同版本的页面加载不同版本的静态资源，这样可以不

レイン 2019/03/01 上午9:36
除非只有一台超级服务器

断线人偶 2019/03/01 上午9:36
静态页面带hash，先部署静态资源，然后再部署动态请求的服务

断线人偶 2019/03/01 上午9:36
静态资源带上hash

レイン 2019/03/01 上午9:37
怎么可能html 带hash

レイン 2019/03/01 上午9:37
不会这么做的

undefined 2019/03/01 上午9:37
那就做健康检查呀，机器开始发布的时候，告诉nginx忽略这台机器，第一台机器好的时候，封闭其他服务器访问就可以了

☀💤喵喵 2019/03/01 上午9:37
这项目好大啊，还用几个服务器

☀💤喵喵 2019/03/01 上午9:37
[什么]

☀💤喵喵 2019/03/01 上午9:37
为啥要用那么多服务器呀

断线人偶 2019/03/01 上午9:37
html不带hash，我是说静态资源带hash

undefined 2019/03/01 上午9:38
为什么静态资源会和html在一台服务器上，cdn不是单独的服务器么。。

陌上 2019/03/01 上午9:38
这有什么为啥的，业务需求

断线人偶 2019/03/01 上午9:38
然后如果html是老的，无非是请求老的静态资源

レイン 2019/03/01 上午9:38
公司大啊，所以小公司不会存在这个问题[捂脸]

断线人偶 2019/03/01 上午9:38
然后新的html走新的静态资源

陌上 2019/03/01 上午9:38
所以你静态资源不要覆盖就行了

陌上 2019/03/01 上午9:38
就按照版本分开同时存在，定期清理老的

断线人偶 2019/03/01 上午9:38
我这边部署时，静态资源都是带hash的，不进行覆盖部署

ChasLui 2019/03/01 上午9:39
估计你们是静态资源都没带版本号也没带 hash 吧

ChasLui 2019/03/01 上午9:39
每次发布等于覆盖了

陌上 2019/03/01 上午9:39
你直接带hash不分版本，到后期东西越来越多维护起来都麻烦

レイン 2019/03/01 上午9:40
带了版本号的

陌上 2019/03/01 上午9:40
带了版本号还有什么问题

undefined 2019/03/01 上午9:40
。。他的意思应该是，请求从A服务器获取Html但是从B服务器获取静态资源了

レイン 2019/03/01 上午9:40
带了版本号跟非覆盖式发布是两回事

レイン 2019/03/01 上午9:40
带了版本号是覆盖式发布

レイン 2019/03/01 上午9:40
对

レイン 2019/03/01 上午9:40
undefined 懂我

断线人偶 2019/03/01 上午9:41
你说的版本号是指url的查询字符串中带了版本号吧……

undefined 2019/03/01 上午9:41
CDN应该是一个单独的集群

レイン 2019/03/01 上午9:41
是的

陌上 2019/03/01 上午9:41
你静态资源不是单独集群么

レイン 2019/03/01 上午9:41
vue发布的时候都是build后无差别的把构建后的包发布到各个节点

レイン 2019/03/01 上午9:42
模版和资源在一起的

レイン 2019/03/01 上午9:42
你们都是分开的？

undefined 2019/03/01 上午9:42
恩

断线人偶 2019/03/01 上午9:42
单独的

陌上 2019/03/01 上午9:42
单独做的啊，我们静态资源是放oss的

undefined 2019/03/01 上午9:42
静态资源单独上CDN

レイン 2019/03/01 上午9:42
你们cdn只放静态资源 不放html模版？

断线人偶 2019/03/01 上午9:42
静态资源单独上CDN+1

undefined 2019/03/01 上午9:43
html走vanish

レイン 2019/03/01 上午9:43
那你们模版单独放一个服务器还是多个

断线人偶 2019/03/01 上午9:43
多个

断线人偶 2019/03/01 上午9:43
但静态资源是带hash的，也就是说新老资源是同时存在的

レイン 2019/03/01 上午9:44
那就没差啊，还是会有问题

断线人偶 2019/03/01 上午9:44
如果请求到的是老的html，就走老的资源，请求到新的html就走新资源

断线人偶 2019/03/01 上午9:44
不会有问题

ChasLui 2019/03/01 上午9:44
不会有问题 访问老 html 加载老资源  访问新 html 加载新资源

陌上 2019/03/01 上午9:44
你进A服务器，新的html，访问的是CDN新的资源。有人进了B服务器，是老的html，访问CDN上老的资源

陌上 2019/03/01 上午9:45
还是有问题的问题出在哪

レイン 2019/03/01 上午9:45
所以你们是先发布静态 再发布模版对吧

ChasLui 2019/03/01 上午9:45
当然啊

レイン 2019/03/01 上午9:45
等等我缕缕

陌上 2019/03/01 上午9:45
静态资源肯定是先上传的

レイン 2019/03/01 上午9:45
有点乱

断线人偶 2019/03/01 上午9:46
肯定是先发布静态资源……不然就会出现请求404了

undefined 2019/03/01 上午9:46
一般的过程是先构建，再发布，构建把页面build了，静态资源上cdn，然后再一台一台机器发布html

. 2019/03/01 上午9:49
为什么不凌晨再release

呼吸 2019/03/01 上午9:49
紧急发布不能等

undefined 2019/03/01 上午9:49
一般不是非常大的改动，不需要凌晨release吧

呼吸 2019/03/01 上午9:49
[奸笑]

陌上 2019/03/01 上午9:50
选时间只是降低了问题带来的副作用但是并没有解决问题

レイン 2019/03/01 上午9:50
好像是没有问题了

レイン 2019/03/01 上午9:50
按照你们的套路来

陌上 2019/03/01 上午9:50
你这样就等于变成滚动式发布了

陌上 2019/03/01 上午9:50
肯定没问题啊

レイン 2019/03/01 上午9:50
都是凌晨发的。。。。

レイン 2019/03/01 上午9:50
凌晨三点

ChasLui 2019/03/01 上午9:51
凌晨发布不是解决问题的根本办法

レイン 2019/03/01 上午9:51
中午我得给我老大说一下，昨晚他把我搞蒙了

レイン 2019/03/01 上午9:51
关键还是要非覆盖式发布啊

undefined 2019/03/01 上午9:51
嗯啊

陌上 2019/03/01 上午9:51
覆盖式有问题的

陌上 2019/03/01 上午9:52
比如你上线发现了问题，也没有办法很快回滚，静态资源都覆盖了，还要重新把上版本代码重新打包发布

ChasLui 2019/03/01 上午9:52
而且也方便回滚,  要是万一出问题了, 把 html 还原就好了

レイン 2019/03/01 上午9:52
不，其实关键是要把html 和静态资源分开

レイン 2019/03/01 上午9:52
不能放一起上

レイン 2019/03/01 上午9:53
多谢 大佬们🙏



### NO2


#### 问题描述
请问vue-cli 3.0 怎么配置 配置 https://aaa.bbb.tech/index.html，   ，   build时改成  成  https://aaa.bbb.tech/staff/index.html 这种额 这种额
#### 问题解答
https://cli.vuejs.org/zh/config/#baseurl

去看看chain-webpak的api应该都有

### NO3

#### 问题描述
大佬们，有个换系统主题样式的需求，字体颜色可以解决，但是图标颜色有没有好的建议哈？

图标我现在是用的图片
#### 问题解答
Anx& 2019/03/01 上午11:11
svg 还是 font-icon

undefined 2019/03/01 上午11:12
原来是红色图标 要粉色就叠个CSS的白色透明遮罩上去，当然还是font-icon最好

简默丶Xs 2019/03/01 上午11:13
@undefined font-icon有文档吗，可以给我看看吗

L - 勋 2019/03/01 上午11:16
字体颜色是以什么方式换的，是更换样式文件吗？如果要换ui给的图片，直接改背景图路径不就行了

简默丶Xs 2019/03/01 上午11:16
不可能项目里放那么多不同颜色的图片1

简默丶Xs 2019/03/01 上午11:16
不现实啊

undefined 2019/03/01 上午11:16
iconfont.cn

undefined 2019/03/01 上午11:17
阿里的图标库，你可以参考下他的使用方式

undefined 2019/03/01 上午11:17
可以直接修改color来改变图标颜色的


### NO4

#### 问题描述

#### 问题解答

### NO5

#### 问题描述

#### 问题解答